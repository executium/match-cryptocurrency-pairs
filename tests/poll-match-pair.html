<!---

    /*
    **
    ** Test script to output results using jQuery 3.5.1 and setInterval()
    ** Change `url` and `intervalMilliseconds`
    ** This particular script does not really require polling as it rarely changes. However, it serves as a good example of how you can poll data.
    **
    **/

--->
<!DOCTYPE html>
<html>
<head>
    <title>Example</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>body{font-family: Arial;}</style>
    <script>url='https://marketdata.executium.com/api/v2/public/match-pair?code=btcusdt'; intervalMilliseconds=60000;</script>
</head>
<body>

<h1></h1>
<pre style="white-space: pre-wrap;" id="output"></pre>
<script>

setInterval(function()
{
    requestEndpoint(url);

},intervalMilliseconds );

function requestEndpoint(url)
{
    $.ajax
    ({
        type:"POST",
        url:url,
        data:'expand=true',
        cache:false,
        crossDomain: true,
        xhrFields: { withCredentials: true},
        timeout:6000,
        error: function(data)
        {
            console.log('Error',data);
        },
        scriptCharset:"script",dataType:"",success:function(data)
        {
            console.log('Success',data);

            $('#output').empty().html('<strong>'+new Date()+"</strong>\n<strong>URL: "+url+"</strong>\n<strong>Interval: "+intervalMilliseconds+"ms</strong>\n\n"+print_r(data));
        }

    });
}

requestEndpoint(url);


function print_r(json)
{
    if (typeof json != 'string') {
         json = JSON.stringify(json, undefined, 2);
    }
    json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, function (match) {
        var cls = 'number';
        if (/^"/.test(match)) {
            if (/:$/.test(match)) {
                cls = 'key';
            } else {
                cls = 'string';
            }
        } else if (/true|false/.test(match)) {
            cls = 'boolean';
        } else if (/null/.test(match)) {
            cls = 'null';
        }
        return '<span class="' + cls + '">' + match + '</span>';
    });
}


</script>

<!---

Example of output:

Sat Jul 11 2020 13:45:04 GMT+0700 (Indochina Time)
URL: https://marketdata.executium.com/api/v2/public/match-pair?code=btcusdt
Interval: 10000ms

{
  "data": {
    "BTCUSDT": {
      "pair": "btcusdt",
      "count": 14,
      "active": [
        "Binance",
        "Bitfinex",
        "Bitmart",
        "Bitmax",
        "Bittrex",
        "Ftx",
        "Gateio",
        "Huobipro",
        "Kraken",
        "Kucoin",
        "Liquid",
        "Okex",
        "Poloniex",
        "Upbit"
      ],
      "detail": {
        "binance": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 0.01,
          "pp": 2,
          "pa": 6
        },
        "bitfinex": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "UST",
          "base": "BTC",
          "min": 0.000009999999999999999,
          "pp": 5,
          "pa": -1
        },
        "bitmart": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": -1,
          "pp": 2,
          "pa": 5
        },
        "bitmax": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "pp": 9,
          "pa": 5
        },
        "bittrex": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 1e-8,
          "pp": 8,
          "pa": 8
        },
        "ftx": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 0.5,
          "pp": 0.5,
          "pa": 0.0001
        },
        "gateio": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "usdt",
          "base": "btc",
          "min": 0.01,
          "pp": 2,
          "pa": 8
        },
        "huobipro": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "usdt",
          "base": "btc",
          "min": 0.01,
          "pp": 2,
          "pa": 6
        },
        "kraken": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "XXBT",
          "min": 0.1,
          "pp": 1,
          "pa": 8
        },
        "kucoin": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 0.1,
          "pp": 1,
          "pa": 8
        },
        "liquid": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 0.000001,
          "pp": 6,
          "pa": 8
        },
        "okex": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 0.1,
          "pp": 0.1,
          "pa": 1e-8
        },
        "poloniex": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 1e-8,
          "pp": 8,
          "pa": 8
        },
        "upbit": {
          "id": "btcusdt",
          "symbol": "BTC/USDT",
          "quote": "USDT",
          "base": "BTC",
          "min": 1e-8,
          "pp": 8,
          "pa": 8
        }
      },
      "possible_combinations": 196
    }
  },
  "meta": {
    "api_version": 2,
    "reqid": "41877G46957T1594449904",
    "system_version": "2.0.5",
    "endpoint": "public/match-pair",
    "status": 200,
    "timezone": "UTC",
    "request": "api/v2/public/match-pair",
    "auth_required": false,
    "ms": 1594449904352,
    "time": 1594449904,
    "process_time": 0.031023,
    "process_full": 0.031661,
    "requester": "<YOUR-IP>"
  }
}

--->
</body>
</html>
